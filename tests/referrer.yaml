model:
    schema-server: 'local://'
    use: invenio
    plugins:
        builder:
            disable: [script_sample_data]
                
    properties:
        metadata:
            properties:
                obj{}:
                    ^id: anchor-obj
                    test: keyword
                    id: keyword
                arr[]:
                    type: object
                    ^id: anchor-arr
                    properties:
                        test: keyword
                        id: keyword
                arrobj[]:
                    type: object
                    id: anchor-arrobj
                    properties:
                        test: keyword
                        id: keyword

                # internal references outside array that point
                # to single object, array or object array
                internal-ref:
                    type: relation
                    model: "#anchor-obj"
                    keys: [id, test]

                internal-ref-arr:
                    type: relation
                    model: "#anchor-arr"
                    keys: [id, test]

                internal-ref-arrobj:
                    type: relation
                    model: "#anchor-arrobj"
                    keys: [id, test]

                # array referencing array
                internal-array-ref-array[]:
                    type: relation
                    model: "#anchor-arr"
                    keys: [id, test]

                # object inside array
                internal-array-nested[]:
                    type: "object"
                    properties:
                        ref:
                            type: relation
                            model: "#anchor-arr"
                            keys: [id, test]

                invenio-ref:
                    type: relation
                    model: referred
                invenio-array[]:
                    type: relation
                    model: referred
                invenio-nested[]:
                    type: "object"
                    properties:
                        ref:
                            type: relation
                            model: referred
                            name: invenio-nested
                invenio-array-nested[]:
                    type: "object"
                    properties:
                        ref-arr[]:
                            type: relation
                            model: referred
                ref:
                    type: relation
                    model: referred
                    flatten: true
                array[]:
                    type: relation
                    model: referred
                    name: array
                    flatten: true
                nested[]:
                    type: "object"
                    properties:
                        ref:
                            type: relation
                            model: referred
                            name: nested
                            flatten: true
                array-nested[]:
                    type: "object"
                    properties:
                        ref-arr[]:
                            type: relation
                            model: referred
                            flatten: true
                cf:
                    type: relation
                    model: referred
                    flatten: true
                    keys: 
                    - id
                    - metadata.title
                    - key: test
                      model: 
                          type: keyword
                # internal-ref:
                #     type: relation
                #     model: referred
                # internal-array[]:
                #     type: relation
                #     model: referred
                # internal-nested[]:
                #     type: "object"
                #     properties:
                #         ref:
                #             type: relation
                #             model: referred
                #             name: invenio-nested
                # internal-array-nested[]:
                #     type: "object"
                #     properties:
                #         ref-arr[]:
                #             type: relation
                #             model: referred
